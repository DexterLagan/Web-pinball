<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stage 3A — visual only</title>
<style>
  html,body{margin:0;height:100%;background:#000;overflow:hidden}
  #log{position:fixed;top:0;left:0;right:0;background:#111;color:#9ee;font:12px/1.5 system-ui;padding:8px;z-index:99999;white-space:pre-wrap}
</style>
</head>
<body>
<div id="log">Booting…</div>
<script type="module">
const logEl=document.getElementById('log'); const log=m=>logEl.textContent+=`\n${m}`;
try{
  const THREE = await import('./vendor/three.min.js'); // your local ESM file
  log('THREE r'+THREE.REVISION+' loaded');

  const scene=new THREE.Scene();
  // TEMP: comment out background so clearColor shows through
  // scene.background=new THREE.Color(0x15202b);

  const camera=new THREE.PerspectiveCamera(60, 1, 0.1, 100);
  camera.position.set(0,1.5,3); camera.lookAt(0,1,0);

  const renderer=new THREE.WebGLRenderer({antialias:true, alpha:false, preserveDrawingBuffer:true});
  document.body.appendChild(renderer.domElement);
  // Force canvas size + styling
  const c=renderer.domElement;
  c.style.position='fixed'; c.style.left='0'; c.style.top='0'; c.style.zIndex='10000'; c.style.border='8px solid lime';
  renderer.setClearColor(0xff00ff,1);

  function sizeNow(src){
    const vw = Math.round(document.documentElement.clientWidth  || window.innerWidth  || 1);
    const vh = Math.round(document.documentElement.clientHeight || window.innerHeight || 1);
    renderer.setPixelRatio(Math.min(2, devicePixelRatio||1));
    renderer.setSize(vw,vh,false);
    camera.aspect=vw/Math.max(1,vh); camera.updateProjectionMatrix();
    const r=c.getBoundingClientRect();
    log(`resize ${src}: rect=${Math.round(r.width)}x${Math.round(r.height)}`);
  }
  sizeNow('boot'); addEventListener('resize',()=>sizeNow('resize'));

  // Big red cube you cannot miss
  const cube=new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshBasicMaterial({color:0xff5555}));
  cube.position.set(0,1,0); scene.add(cube);

  // Grid floor for context
  scene.add(new THREE.GridHelper(10,10,0x444444,0x444444));

  function loop(t){
    cube.rotation.y=t*0.0015; cube.rotation.x=t*0.001;
    renderer.render(scene,camera);
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);
}catch(e){
  log('❌ '+(e?.message||e));
}
</script>
</body>
</html>